<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Chapter 15. Cypher Query Language</title><link rel="stylesheet" type="text/css" href="docbook-xsl.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.76.1" /><link rel="home" href="index.html" title="The Neo4j Manual v1.9.M04" /><link rel="up" href="reference-documentation.html" title="Part III. Reference" /><link rel="prev" href="auto-indexing.html" title="14.12. Automatic Indexing" /><link rel="next" href="query-operators.html" title="15.1. Operators" /><link rel="preface" href="preface.html" title="Preface" /><link rel="part" href="introduction.html" title="Part I. Introduction" /><link rel="chapter" href="introduction-highlights.html" title="Chapter 1. Neo4j Highlights" /><link rel="chapter" href="graphdb-concepts.html" title="Chapter 2. Graph Database Concepts" /><link rel="chapter" href="graphdb-neo4j.html" title="Chapter 3. The Neo4j Graph Database" /><link rel="part" href="tutorials.html" title="Part II. Tutorials" /><link rel="chapter" href="tutorials-java-embedded.html" title="Chapter 4. Using Neo4j embedded in Java applications" /><link rel="chapter" href="tutorials-rest.html" title="Chapter 5. Neo4j Remote Client Libraries" /><link rel="chapter" href="tutorial-traversal.html" title="Chapter 6. The Traversal Framework" /><link rel="chapter" href="data-modeling-examples.html" title="Chapter 7. Data Modeling Examples" /><link rel="chapter" href="languages.html" title="Chapter 8. Languages" /><link rel="chapter" href="tutorials-python-embedded.html" title="Chapter 9. Using Neo4j embedded in Python applications" /><link rel="chapter" href="server-extending.html" title="Chapter 10. Extending the Neo4j Server" /><link rel="part" href="reference-documentation.html" title="Part III. Reference" /><link rel="chapter" href="capabilities.html" title="Chapter 11. Capabilities" /><link rel="chapter" href="transactions.html" title="Chapter 12. Transaction Management" /><link rel="chapter" href="import.html" title="Chapter 13. Data Import" /><link rel="chapter" href="indexing.html" title="Chapter 14. Indexing" /><link rel="chapter" href="cypher-query-lang.html" title="Chapter 15. Cypher Query Language" /><link rel="chapter" href="graph-algo.html" title="Chapter 16. Graph Algorithms" /><link rel="chapter" href="server.html" title="Chapter 17. Neo4j Server" /><link rel="chapter" href="rest-api.html" title="Chapter 18. REST API" /><link rel="chapter" href="python-embedded.html" title="Chapter 19. Python embedded bindings" /><link rel="part" href="operations.html" title="Part IV. Operations" /><link rel="chapter" href="deployment.html" title="Chapter 20. Installation &amp; Deployment" /><link rel="chapter" href="embedded-configuration.html" title="Chapter 21. Configuration &amp; Performance" /><link rel="chapter" href="ha.html" title="Chapter 22. High Availability" /><link rel="chapter" href="operations-backup.html" title="Chapter 23. Backup" /><link rel="chapter" href="operations-security.html" title="Chapter 24. Security" /><link rel="chapter" href="operations-monitoring.html" title="Chapter 25. Monitoring" /><link rel="part" href="tools.html" title="Part V. Tools" /><link rel="chapter" href="tools-webadmin.html" title="Chapter 26. Web Administration" /><link rel="chapter" href="shell.html" title="Chapter 27. Neo4j Shell" /><link rel="part" href="community.html" title="Part VI. Community" /><link rel="chapter" href="community-support.html" title="Chapter 28. Community Support" /><link rel="chapter" href="community-contributing.html" title="Chapter 29. Contributing to Neo4j" /><link rel="appendix" href="manpages.html" title="Appendix A. Manpages" /><link rel="refentry" href="re01.html" title="neo4j" /><link rel="refentry" href="re02.html" title="neo4j-shell" /><link rel="refentry" href="re03.html" title="neo4j-backup" /><link rel="appendix" href="questions.html" title="Appendix B. Questions &amp; Answers" /><link rel="section" href="query-operators.html" title="15.1. Operators" /><link rel="section" href="cypher-expressions.html" title="15.2. Expressions" /><link rel="section" href="cypher-parameters.html" title="15.3. Parameters" /><link rel="section" href="cypher-identifiers.html" title="15.4. Identifiers" /><link rel="section" href="cypher-comments.html" title="15.5. Comments" /><link rel="section" href="query-updating.html" title="15.6. Updating the graph" /><link rel="section" href="query-transactions.html" title="15.7. Transactions" /><link rel="section" href="introduction-pattern.html" title="15.8. Patterns" /><link rel="section" href="query-start.html" title="15.9. Start" /><link rel="section" href="query-match.html" title="15.10. Match" /><link rel="section" href="query-where.html" title="15.11. Where" /><link rel="section" href="query-return.html" title="15.12. Return" /><link rel="section" href="query-aggregation.html" title="15.13. Aggregation" /><link rel="section" href="query-order.html" title="15.14. Order by" /><link rel="section" href="query-limit.html" title="15.15. Limit" /><link rel="section" href="query-skip.html" title="15.16. Skip" /><link rel="section" href="query-with.html" title="15.17. With" /><link rel="section" href="query-create.html" title="15.18. Create" /><link rel="section" href="query-create-unique.html" title="15.19. Create Unique" /><link rel="section" href="query-set.html" title="15.20. Set" /><link rel="section" href="query-delete.html" title="15.21. Delete" /><link rel="section" href="query-foreach.html" title="15.22. Foreach" /><link rel="section" href="query-function.html" title="15.23. Functions" /><link rel="section" href="cypher-compatibility.html" title="15.24. Compatibility" /><link rel="section" href="examples-from-sql-to-cypher.html" title="15.25. From SQL to Cypher" /><link rel="copyright" href="ln-idp3423008.html" title="License: Creative Commons 3.0" />


<!-- favicon -->

<link rel="shortcut icon" href="http://neo4j.org/favicon.ico" type="image/vnd.microsoft.icon" />
<link rel="icon" href="http://neo4j.org/favicon.ico" type="image/x-icon" />

<!-- style -->

<link href="css/shCore.css" rel="stylesheet" type="text/css" />
<link href="css/shCoreEclipse.css" rel="stylesheet" type="text/css" />
<link href="css/shThemeEclipse.css" rel="stylesheet" type="text/css" />
<link href="css/neo.css" rel="stylesheet" type="text/css" />

<!-- Syntax Highlighter -->

<script type="text/javascript" src="js/shCore.js"></script>
<script type="text/javascript" src="js/shBrushJava.js"></script>
<script type="text/javascript" src="js/shBrushJScript.js"></script>
<script type="text/javascript" src="js/shBrushBash.js"></script>
<script type="text/javascript" src="js/shBrushPlain.js"></script>
<script type="text/javascript" src="js/shBrushXml.js"></script>
<script type="text/javascript" src="js/shBrushGroovy.js"></script>
<script type="text/javascript" src="js/shBrushCypher.js"></script>
<script type="text/javascript" src="js/shBrushScala.js"></script>
<script type="text/javascript" src="js/shBrushSql.js"></script>
<script type="text/javascript" src="js/shBrushPython.js"></script>
<script type="text/javascript" src="js/shBrushProperties.js"></script>

<!-- activate when needed
<script type="text/javascript" src="js/shBrushRuby.js"></script>
<script type="text/javascript" src="js/shBrushCSharp.js"></script>
-->
 
<script type="text/javascript">
  SyntaxHighlighter.defaults['tab-size'] = 4;
  SyntaxHighlighter.defaults['gutter'] = false;
  SyntaxHighlighter.defaults['toolbar'] = false;
  SyntaxHighlighter.all()
</script>

<!-- JQuery -->

<script type="text/javascript" src="js/jquery-1.6.4.min.js"></script>

<!-- Replace SVG for browsers that lack support. -->
<script type="text/javascript" src="js/svgreplacer.js"></script>

<!-- Image Scaler -->

<script type="text/javascript" src="js/imagescaler.js"></script>

<!-- Table Styler -->

<script type="text/javascript" src="js/tablestyler.js"></script>

<!-- Version -->

<script type="text/javascript" src="js/version.js"></script>

<!-- Offline Sidebar -->

<script type="text/javascript" src="js/sidebar.js"></script>


<div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">The Neo4j Manual</a></span> &gt; <span class="breadcrumb-link"><a href="reference-documentation.html">Reference</a></span> &gt; <span class="breadcrumb-node">Cypher Query Language</span></div></head><body><div class="navheader"><table width="100%" summary="Navigation header"><tr><td width="20%" align="left"><a accesskey="p" href="auto-indexing.html">Prev</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="query-operators.html">Next</a></td></tr></table><hr /></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="cypher-query-lang"></a>Chapter 15. Cypher Query Language</h2></div></div></div><div class="toc"><p><strong>Table of Contents</strong></p><dl><dt><span class="section"><a href="query-operators.html">15.1. Operators</a></span></dt><dt><span class="section"><a href="cypher-expressions.html">15.2. Expressions</a></span></dt><dt><span class="section"><a href="cypher-parameters.html">15.3. Parameters</a></span></dt><dt><span class="section"><a href="cypher-identifiers.html">15.4. Identifiers</a></span></dt><dt><span class="section"><a href="cypher-comments.html">15.5. Comments</a></span></dt><dt><span class="section"><a href="query-updating.html">15.6. Updating the graph</a></span></dt><dt><span class="section"><a href="query-transactions.html">15.7. Transactions</a></span></dt><dt><span class="section"><a href="introduction-pattern.html">15.8. Patterns</a></span></dt><dt><span class="section"><a href="query-start.html">15.9. Start</a></span></dt><dt><span class="section"><a href="query-match.html">15.10. Match</a></span></dt><dt><span class="section"><a href="query-where.html">15.11. Where</a></span></dt><dt><span class="section"><a href="query-return.html">15.12. Return</a></span></dt><dt><span class="section"><a href="query-aggregation.html">15.13. Aggregation</a></span></dt><dt><span class="section"><a href="query-order.html">15.14. Order by</a></span></dt><dt><span class="section"><a href="query-limit.html">15.15. Limit</a></span></dt><dt><span class="section"><a href="query-skip.html">15.16. Skip</a></span></dt><dt><span class="section"><a href="query-with.html">15.17. With</a></span></dt><dt><span class="section"><a href="query-create.html">15.18. Create</a></span></dt><dt><span class="section"><a href="query-create-unique.html">15.19. Create Unique</a></span></dt><dt><span class="section"><a href="query-set.html">15.20. Set</a></span></dt><dt><span class="section"><a href="query-delete.html">15.21. Delete</a></span></dt><dt><span class="section"><a href="query-foreach.html">15.22. Foreach</a></span></dt><dt><span class="section"><a href="query-function.html">15.23. Functions</a></span></dt><dt><span class="section"><a href="cypher-compatibility.html">15.24. Compatibility</a></span></dt><dt><span class="section"><a href="examples-from-sql-to-cypher.html">15.25. From SQL to Cypher</a></span></dt></dl></div><p><span class="emphasis"><em>Cypher</em></span> is a declarative graph query language that allows for expressive and efficient querying and updating of the
graph store without having to write traversals through the graph structure in code. Cypher is still growing and
maturing, and that means that there probably will be breaking syntax changes. It also means that it has not undergone
the same rigorous performance testing as other Neo4j components.</p><p>Cypher is designed to be a humane query language, suitable for both developers and (importantly, we think) operations
professionals who want to make ad-hoc queries on the database. Our guiding goal is to make the simple things simple,
and the complex things possible. Its constructs are based on English prose and neat iconography, which helps to make
it (somewhat) self-explanatory.</p><p>Cypher is inspired by a number of different approaches and builds upon established practices for expressive querying.
Most of the keywords like <code class="literal">WHERE</code> and <code class="literal">ORDER BY</code> are inspired by <a class="ulink" href="http://en.wikipedia.org/wiki/SQL" target="_top">SQL</a>. Pattern matching
borrows expression approaches from <a class="ulink" href="http://en.wikipedia.org/wiki/SPARQL" target="_top">SPARQL</a>.</p><p>Being a declarative language, Cypher focuses on the clarity of expressing <span class="emphasis"><em>what</em></span> to retrieve from a graph, not <span class="emphasis"><em>how</em></span>
to do it, in contrast to imperative languages like Java, and scripting languages like
<a class="ulink" href="http://gremlin.tinkerpop.com" target="_top">Gremlin</a> (supported via the <a class="xref" href="gremlin-plugin.html" title="18.18. Gremlin Plugin">Section 18.18, “Gremlin Plugin”</a>) and
<a class="ulink" href="http://neo4j.rubyforge.org/" target="_top">the JRuby Neo4j bindings</a>. This makes the concern of how to optimize queries an
implementation detail not exposed to the user.</p><p>The query language is comprised of several distinct clauses.</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<code class="literal">START</code>: Starting points in the graph, obtained via index lookups or by element IDs.
</li><li class="listitem">
<code class="literal">MATCH</code>: The graph pattern to match, bound to the starting points in <code class="literal">START</code>.
</li><li class="listitem">
<code class="literal">WHERE</code>: Filtering criteria.
</li><li class="listitem">
<code class="literal">RETURN</code>: What to return.
</li><li class="listitem">
<code class="literal">CREATE</code>: Creates nodes and relationships.
</li><li class="listitem">
<code class="literal">DELETE</code>: Removes nodes, relationships and properties.
</li><li class="listitem">
<code class="literal">SET</code>: Set values to properties.
</li><li class="listitem">
<code class="literal">FOREACH</code>: Performs updating actions once per element in a list.
</li><li class="listitem">
<code class="literal">WITH</code>: Divides a query into multiple, distinct parts.
</li></ul></div><p>Let’s see three of them in action.</p><p>Imagine an example graph like the following one:</p><div class="figure"><a id="idp8096704"></a><p class="title"><strong>Figure 15.1. Example Graph</strong></p><div class="figure-contents"><a class="ulink" href="images/Example-Graph-cypher-intro.svg" target="_top">
<span class="inlinemediaobject"><img src="images/Example-Graph-cypher-intro.svg" alt="Example-Graph-cypher-intro.svg" /></span>
</a></div></div><br class="figure-break" /><p>For example, here is a query which finds a user called John in an index and then traverses the graph looking for friends of Johns friends (though not his direct friends) before returning both John and any friends-of-friends that are found.</p><pre class="programlisting brush: cypher">START john=node:node_auto_index(name = 'John')
MATCH john-[:friend]-&gt;()-[:friend]-&gt;fof
RETURN john, fof</pre><p>Resulting in:</p><div class="queryresult table"><table cellspacing="0" cellpadding="0" border="1"><colgroup><col class="col1" /><col class="col2" /></colgroup><thead><tr><th align="left" valign="top">john</th><th align="left" valign="top">fof</th></tr></thead><tfoot><tr><th colspan="2" align="left" valign="top">2 rows
</th></tr><tr><th colspan="2" align="left" valign="top">49 ms</th></tr></tfoot><tbody><tr><td align="left" valign="top"><p><code class="literal">Node[4]{name:"John"}</code></p></td><td align="left" valign="top"><p><code class="literal">Node[2]{name:"Maria"}</code></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">Node[4]{name:"John"}</code></p></td><td align="left" valign="top"><p><code class="literal">Node[3]{name:"Steve"}</code></p></td></tr></tbody></table></div><p>Next up we will add filtering to set more parts in motion:</p><p>In this next example, we take a list of users (by node ID) and traverse the graph looking for those other users that have an outgoing <code class="literal">friend</code> relationship, returning only those followed users who have a <code class="literal">name</code> property starting with <code class="literal">S</code>.</p><pre class="programlisting brush: cypher">START user=node(5,4,1,2,3)
MATCH user-[:friend]-&gt;follower
WHERE follower.name =~ 'S.*'
RETURN user, follower.name</pre><p>Resulting in:</p><div class="queryresult table"><table cellspacing="0" cellpadding="0" border="1"><colgroup><col class="col1" /><col class="col2" /></colgroup><thead><tr><th align="left" valign="top">user</th><th align="left" valign="top">follower.name</th></tr></thead><tfoot><tr><th colspan="2" align="left" valign="top">2 rows
</th></tr><tr><th colspan="2" align="left" valign="top">2 ms</th></tr></tfoot><tbody><tr><td align="left" valign="top"><p><code class="literal">Node[5]{name:"Joe"}</code></p></td><td align="left" valign="top"><p><code class="literal">"Steve"</code></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">Node[4]{name:"John"}</code></p></td><td align="left" valign="top"><p><code class="literal">"Sara"</code></p></td></tr></tbody></table></div><p>To use Cypher from Java, see <a class="xref" href="tutorials-cypher-java.html" title="4.10. Execute Cypher Queries from Java">Section 4.10, “Execute Cypher Queries from Java”</a>.
For more Cypher examples, see <a class="xref" href="data-modeling-examples.html" title="Chapter 7. Data Modeling Examples">Chapter 7, <em>Data Modeling Examples</em></a> as well.</p></div><HR xmlns=""></HR><a xmlns="" href="ln-idp3423008.html"><p xmlns="http://www.w3.org/1999/xhtml" class="copyright">Copyright © 2013 Neo Technology</p></a><div class="navfooter"><hr /><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="auto-indexing.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="reference-documentation.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="query-operators.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top"> </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> </td></tr></table></div></body></html>
